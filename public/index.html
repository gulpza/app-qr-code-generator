<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator จากไฟล์ Excel</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card shadow-lg">
                    <div class="card-header bg-primary text-white text-center">
                        <h1 class="card-title mb-0">
                            <i class="fas fa-qrcode me-2"></i>
                            QR Code Generator
                        </h1>
                        <p class="mb-0 mt-2">สร้าง QR Code จากไฟล์ Excel</p>
                    </div>
                    <div class="card-body p-5">
                        <form id="uploadForm" enctype="multipart/form-data">
                            <div class="mb-4">
                                <label for="excelFile" class="form-label h5">
                                    <i class="fas fa-file-excel me-2 text-success"></i>
                                    เลือกไฟล์ Excel
                                </label>
                                <div class="input-group">
                                    <input type="file" 
                                           class="form-control form-control-lg" 
                                           id="excelFile" 
                                           name="excelFile" 
                                           accept=".xlsx,.xls"
                                           required>
                                    <label class="input-group-text" for="excelFile">
                                        <i class="fas fa-upload"></i>
                                    </label>
                                </div>
                                <div class="form-text d-flex justify-content-between align-items-center">
                                    <span>
                                        <i class="fas fa-info-circle me-1"></i>
                                        รองรับไฟล์ .xlsx และ .xls เท่านั้น
                                    </span>
                                    <a href="/download-template" class="btn btn-sm btn-outline-success">
                                        <i class="fas fa-download me-1"></i>
                                        ดาวน์โหลด Template
                                    </a>
                                </div>
                            </div>

                            <div class="mb-4">
                                <div class="alert alert-info" role="alert">
                                    <h6 class="alert-heading">
                                        <i class="fas fa-lightbulb me-2"></i>
                                        วิธีใช้งาน:
                                    </h6>
                                    <ul class="mb-0">
                                        <li>คลิก "ดาวน์โหลด Template" เพื่อดาวน์โหลดไฟล์ตัวอย่าง</li>
                                        <li>แก้ไขข้อมูลในไฟล์ Excel: <strong>Column A = Code</strong>, <strong>Column B = Name</strong></li>
                                        <li>อัปโหลดไฟล์ Excel ที่แก้ไขแล้ว</li>
                                        <li>ระบบจะสร้าง QR Code จาก Column A พร้อมแสดง Code ใต้รูป</li>
                                        <li>ไฟล์ ZIP จะถูกดาวน์โหลดอัตโนมัติ</li>
                                    </ul>
                                </div>
                            </div>

                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg">
                                    <i class="fas fa-magic me-2"></i>
                                    สร้าง QR Code
                                </button>
                            </div>
                        </form>

                        <!-- Progress Bar -->
                        <div id="progressContainer" class="mt-4" style="display: none;">
                            <div class="d-flex align-items-center mb-2">
                                <strong>กำลังประมวลผล...</strong>
                                <div class="spinner-border spinner-border-sm ms-2" role="status">
                                    <span class="visually-hidden">Loading...</span>
                                </div>
                            </div>
                            <div class="progress">
                                <div id="progressBar" 
                                     class="progress-bar progress-bar-striped progress-bar-animated" 
                                     role="progressbar" 
                                     style="width: 0%">
                                </div>
                            </div>
                        </div>

                        <!-- Success Message -->
                        <div id="successMessage" class="alert alert-success mt-4" style="display: none;">
                            <h6 class="alert-heading">
                                <i class="fas fa-check-circle me-2"></i>
                                สำเร็จ!
                            </h6>
                            <p class="mb-0">QR Code ถูกสร้างเรียบร้อยแล้ว ไฟล์กำลังดาวน์โหลด...</p>
                        </div>

                        <!-- Error Message -->
                        <div id="errorMessage" class="alert alert-danger mt-4" style="display: none;">
                            <h6 class="alert-heading">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                เกิดข้อผิดพลาด!
                            </h6>
                            <p id="errorText" class="mb-0"></p>
                        </div>
                    </div>
                </div>

                <!-- Features Section -->
                <div class="row mt-5">
                    <div class="col-md-4">
                        <div class="text-center">
                            <div class="feature-icon">
                                <i class="fas fa-file-excel fa-3x text-success"></i>
                            </div>
                            <h5 class="mt-3">รองรับ Excel</h5>
                            <p class="text-muted">อ่านข้อมูลจากไฟล์ .xlsx และ .xls</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="text-center">
                            <div class="feature-icon">
                                <i class="fas fa-qrcode fa-3x text-primary"></i>
                            </div>
                            <h5 class="mt-3">QR Code คุณภาพสูง</h5>
                            <p class="text-muted">สร้าง QR Code ขนาด 300x300 pixels</p>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="text-center">
                            <div class="feature-icon">
                                <i class="fas fa-download fa-3x text-warning"></i>
                            </div>
                            <h5 class="mt-3">ดาวน์โหลด ZIP</h5>
                            <p class="text-muted">รวบรวมไฟล์ทั้งหมดในไฟล์ ZIP เดียว</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="bg-dark text-light text-center py-3 mt-5">
        <div class="container">
            <p class="mb-0">
                <i class="fas fa-code me-2"></i>
                QR Code Generator © 2024
            </p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="script.js"></script>
</body>
</html>